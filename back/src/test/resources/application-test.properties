# Test configuration for Spring Boot tests

# ===============================================
# Test Database Configuration (H2 in-memory)
# ===============================================
spring.datasource.url=jdbc:h2:mem:testdb;MODE=MySQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# ===============================================
# JPA Configuration for Tests
# ===============================================
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# data.sql 실행 비활성화 (테스트에서는 필요없음)
spring.sql.init.mode=never

# ===============================================
# AWS Configuration for Tests (Mock values)
# ===============================================
spring.cloud.aws.credentials.access-key=test-access-key
spring.cloud.aws.credentials.secret-key=test-secret-key
spring.cloud.aws.region.static=us-east-1
spring.cloud.aws.s3.bucket=test-bucket

# EventBridge 설정
aws.eventbridge.bus-name=test-bus
aws.eventbridge.source=orakgaraki.s3.upload.test
aws.eventbridge.detail-type=S3 Object Upload Event Test

# ===============================================
# JWT Configuration for Tests
# ===============================================
jwt.secret=test-super-secret-key-for-jwt-tokens-in-testing
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# ===============================================
# OAuth2 Configuration for Tests
# ===============================================
spring.security.oauth2.client.registration.google.client-id=test-client-id
spring.security.oauth2.client.registration.google.client-secret=test-client-secret
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri=http://localhost:8080/api/login/oauth2/code/google

app.oauth2.redirect-uri=http://localhost:5173/login/success

# ===============================================
# Redis Configuration for Tests
# ===============================================
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.password=

# ===============================================
# Upload Configuration for Tests
# ===============================================
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=100MB
spring.servlet.multipart.enabled=true
spring.servlet.multipart.file-size-threshold=0
s3.upload.path=${java.io.tmpdir}/test-orak-upload
spring.servlet.multipart.location=${s3.upload.path}

# ===============================================
# Actuator Configuration for Tests
# ===============================================
actuator.user=test-user
actuator.password=test-password
actuator.role-name=ACTUATOR

# ===============================================
# Kafka Configuration for Tests (Embedded/Mock)
# ===============================================
spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.consumer.group-id=test-orakgaraki-processing
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value-deserializer=org.apache.kafka.common.serialization.StringDeserializer

# Kafka 토픽 설정
kafka.topics.upload-events=test-upload-events
kafka.topics.processing-status=test-processing-status
kafka.topics.processing-results=test-processing-results

# ===============================================
# Processing Configuration for Tests
# ===============================================
processing.batch.enabled=false
processing.batch.max-concurrent-jobs=1
processing.batch.batch-size=1
processing.batch.interval-ms=1000
processing.batch.retry-attempts=1
processing.batch.retry-delay-ms=100

# Audio/Image processing disabled for tests
processing.audio.format-conversion-enabled=false
processing.audio.metadata-extraction-enabled=false
processing.image.optimization-enabled=false
processing.image.thumbnail-generation-enabled=false

# ===============================================
# Logging Configuration for Tests
# ===============================================
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.com.ssafy.lab.orak=DEBUG
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# ===============================================
# Actuator Configuration for Tests
# ===============================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always
management.server.port=8091